# data preparation
nanjen300.spe <- read.delim ('https://www.davidzeleny.net/anadat-r/data-download/nanjen300-spe.txt', row.names = 1)
nanjen300.env <- read.delim ('https://www.davidzeleny.net/anadat-r/data-download/nanjen300-env.txt', row.names = 1)
spe <- log1p(nanjen300.spe)
env <- nanjen300.env
# NumEcol Homework 7, Author: Andy, Student ID: r09b44010
library(vegan)
# Cluster analysis
bc <- vegdist(spe, method = "bray")
library(cluster)
clust <- agnes(sqrt(bc), method = "ward")
clust
clust.ward <- agnes(sqrt(bc), method = "ward")
clust <- cutree(clust.ward, k = 4)
plot(clust)
clust
plot(clust.ward)
library(dplyr)
clust <- cutree(clust.ward, k = 4) %>% as.hclust()
clust.ward <- agnes(sqrt(bc), method = "ward") %>% as.hclust()
clust <- cutree(clust.ward, k = 4)
plot(clust.ward)
rect.hclust (cluster.ward, k = 4, border = 1:4)
rect.hclust (clust.ward, k = 4, border = 1:4)
# NMDS
nmds <- metaMDS(bc)
ordiplot(nmds)
ordiplot(nmds, type = "n")
points(nmds, bg = clust, pch = (20 + clust))
ordiplot(nmds, type = "n")
points(nmds, bg = clust, pch = (20 + clust), cex = 1.5)
View(nanjen300.spe)
View(spe)
clust.ward <- hclust(sqrt(bc), method = "ward.D")
# clust.ward <- agnes(sqrt(bc), method = "ward") %>% as.hclust()
clust <- cutree(clust.ward, k = 4)
plot(clust.ward)
rect.hclust (clust.ward, k = 4, border = 1:4)
# NMDS
nmds <- metaMDS(bc)
ordiplot(nmds, type = "n")
points(nmds, bg = clust, pch = (20 + clust), cex = 1.5)
clust.ward <- hclust(sqrt(bc), method = "ward.D2")
# clust.ward <- agnes(sqrt(bc), method = "ward") %>% as.hclust()
clust <- cutree(clust.ward, k = 4)
ordiplot(nmds, type = "n")
points(nmds, bg = clust, pch = (20 + clust), cex = 1.5)
clust.ward <- hclust(sqrt(bc), method = "ward.D")
clust <- cutree(clust.ward, k = 4)
plot(clust.ward)
rect.hclust (clust.ward, k = 4, border = 1:4)
# NMDS
nmds <- metaMDS(bc)
ordiplot(nmds, type = "n")
points(nmds, bg = clust, pch = (20 + clust), cex = 1.5)
View(nanjen300.spe)
View(nanjen300.env)
# Distribution map
plot(row ~ column, data = env)
# Distribution map
plot(row ~ column, data = env, bg = clust, pch = (20 + clust))
# Distribution map
elev.m <- xtabs (elev ~ column + row, data = nanjen300.env)
elev.m
contour (x = 1:nrow (elev.m), y = 1:ncol (elev.m), elev.m)
points(row ~ column, data = env, bg = clust, pch = (20 + clust))
points(row ~ column, data = env, bg = clust, pch = (20 + clust), , cex = 1.5)
points(row ~ column, data = env, bg = clust, pch = (20 + clust), cex = 1.5)
points(row ~ column, data = env, bg = clust, pch = (20 + clust), cex = 2)
points(row ~ column, data = env, bg = clust, pch = (20 + clust), cex = 5)
points(row ~ column, data = env, bg = clust, pch = (20 + clust), cex = 4)
contour (x = 1:nrow (elev.m), y = 1:ncol (elev.m), elev.m)
points(row ~ column, data = env, bg = clust, pch = (20 + clust), cex = 4)
ordiplot(nmds, type = "n")
points(nmds, bg = clust, pch = (20 + clust), cex = 4)
ordiplot(nmds, type = "n")
points(nmds, bg = clust, pch = (20 + clust), cex = 2)
source('~/NumEcol/hw7.R', echo=TRUE)
plot(clust.ward)
rect.hclust (clust.ward, k = 4, border = 1:4)
rect.hclust (clust.ward, k = 4, border = 1:4, cex = 2)
rect.hclust (clust.ward, k = 4, border = 1:4)
ordiplot(nmds, type = "n")
points(nmds, bg = clust, pch = (20 + clust), cex = 2)
nmds
contour (x = 1:nrow (elev.m), y = 1:ncol (elev.m), elev.m)
points(row ~ column, data = env, bg = clust, pch = (20 + clust), cex = 4)
# NumEcol Homework 7, Author: Andy, Student ID: r09b44010
library(vegan)
library(dplyr)
# data preparation
nanjen300.spe <- read.delim ('https://www.davidzeleny.net/anadat-r/data-download/nanjen300-spe.txt', row.names = 1)
nanjen300.env <- read.delim ('https://www.davidzeleny.net/anadat-r/data-download/nanjen300-env.txt', row.names = 1)
spe <- log1p(nanjen300.spe)
env <- nanjen300.env
# Cluster analysis
bc <- vegdist(spe, method = "bray")
clust.ward <- hclust(sqrt(bc), method = "ward.D")
clust <- cutree(clust.ward, k = 4)
plot(clust.ward)
rect.hclust (clust.ward, k = 4, border = 1:4)
# NMDS
nmds <- metaMDS(sqrt(bc))
ordiplot(nmds, type = "n")
points(nmds, bg = clust, pch = (20 + clust), cex = 2)
# Distribution map
elev.m <- xtabs (elev ~ column + row, data = nanjen300.env)
contour (x = 1:nrow (elev.m), y = 1:ncol (elev.m), elev.m)
points(row ~ column, data = env, bg = clust, pch = (20 + clust), cex = 4)
